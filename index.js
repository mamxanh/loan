const $=document.querySelector.bind(document),dvp=$("#loan"),ip=$(".progress-interest"),tp=$(".progress-time"),dv=$(".loan-price"),tl=$(".loan-money"),tlp=$(".loan-percent-item"),interest=$("#interest"),time=$("#time"),formatOutput=a=>a.toFixed().replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),formatInput=b=>b.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,","),toNum=b=>b=+b.replaceAll(",","");let loanAPercent=0;dv.oninput=()=>(dv.value=formatInput(dv.value),tl.value=0,loanAPercent=toNum(dv.value)/100,loanAPercent),ip.oninput=()=>20<toNum(ip.value)?ip.value=0:void(interest.value=ip.value),tp.oninput=()=>{if(time.value=tp.value,500<toNum(tp.value))return tp.value=0},tlp.innerText=loan.value+"%",dvp.oninput=()=>{tlp.innerText=dvp.value+"%",tl.value=formatOutput(loanAPercent*dvp.value)},tl.oninput=()=>{tl.value=formatInput(tl.value);let a=(100*(toNum(tl.value)/toNum(dv.value))).toFixed(2);100>=a?(dvp.value=a,tlp.innerText=a.replace(".0","")+"%"):(tl.value=dv.value,tlp.innerText="100%",dvp.value=100)},ip.value=interest.value,interest.oninput=()=>{ip.value=interest.value},time.oninput=()=>{tp.value=time.value},$(".loan_btn").addEventListener("click",()=>{const h=ip.value/12,a=toNum(tl.value),b=toNum(tp.value),c=toNum(dv.value),i=c-a;if(0<h&&0<a&&0<b&&0<c){tbodyHTML="",$(".loan_table").style.display="block",$(".loan_information").style.display="flex";const c=$("tbody");c.innerHTML="";let e=gop=loanAll=goc=lai=0,f="";for(let c=1;c<b+1;c++)goc=a-a/b*c,lai=(a-a/b*(c-1))*(h/100),gop=a/b+lai,e+=lai,loanAll+=gop,tbodyHTML=`<tr>
               <th>Tháng thứ ${c}</th>
               <th>${formatOutput(goc)}</th>
               <th>${formatOutput(a/b)}</th>
               <th>${formatOutput(lai)}</th>
               <th>${formatOutput(gop)}</th>
                      </tr>`,f+=tbodyHTML;c.innerHTML=f,$(".loan-interestall").innerHTML=$(".loan-interest-sum").innerHTML=formatOutput(e)+" \u0111",$(".loan-all").innerHTML=formatOutput(loanAll)+" \u0111",$(".loan-prepay").innerHTML=` (${100-1*dvp.value}%)       `+formatOutput(i)+" \u0111",$(".loan-pay").innerHTML=formatOutput(loanAll+i)+" \u0111",$(".loan-firstmonth").innerHTML=formatOutput(a/b+(a-0*(a/b))*(h/100))+" \u0111",$(".loan-lastmonth").innerHTML=formatOutput(a/b+(a-a/b*(b-1))*(h/100))+" \u0111"}else alert("Vui l\xF2ng nh\u1EADp d\u1EE7 th\xF4ng tin d\u1EF1 to\xE1n")});
